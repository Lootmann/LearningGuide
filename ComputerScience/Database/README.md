# Database

Terms and something.

## Schema

データベースの構造を表現する設計書
データベースは強調したい属性や、見方によって様々な分割の方法がある
で、その分割方法の有名なやつに「三層スキーマ」がある

- 外部スキーマ(概念スキーマ)

  - ユーザから見た DB 画面の入力 UI やデータなど

- 概念スキーマ(論理スキーマ)

  - 開発者から見た DB DB に保持するデータの要素、データ同士の Relation を記述する

- 内部スキーマ(物理スキーマ)

  - 概念スキーマで定義された倫理データモデルをどのように DBMS 内部に格納するかを定義する

それぞれのスキーマの独立性（密な関係にならないように）を保障するために
考え出されたもの、それがスキーマであり、三層はその方法の一つ
NoSQL だったり、Graph だったり、取り扱うデータによって DB は様々あるので
そこではまた別の方法論があるとか無いとか

## Relation

別々のテーブルを関連付けること、またはその関連性のこと よくわからん

- table: Fruit

| id  | name   | price |
| --- | ------ | ----- |
| 1   | apple  | 100   |
| 2   | banana | 200   |
| 3   | orange | 250   |

- table: Buying

| id  | date       | num | fruit_id |
| --- | ---------- | --- | -------- |
| 1   | 2022-03-26 | 2   | 1        |
| 2   | 2022-03-26 | 2   | 3        |
| 3   | 2022-03-26 | 1   | 2        |

`buying` テーブルの `fruit_id` は `Fruit`テーブルの `id` を示しており
`Buying.fruit_id` と `Fruit.id` が一致しているとこを見ると果物の名前がわかる
まさに別々のテーブルが関連付けられている

この関係を Relation があると呼ぶ つまり関係性があるね
`Buying.fruit_id` の列がなければ Relation は無い つまり関係性がない

## Lookup

リレーションで関連付けたテーブルのデータをコピーする機能

## Sharding

DB の分割手法の一つ
データを複数のノードのディスクに分割配置することで
DB へのリクエストを分散し全体のスループとを上げる目的で利用される

基本的に各ノードは独立してデータを保持しているので、各ノードが毎に
自分が担当するデータに対してクエリを実行すればよい

以下の分割方法は `range` という種類のもの
他にもシャードの分け方はたくさんあるらしい

```
app ---> [Node A] ----------> [DB]
   \      user(1 - 1000)
    \
     ---> [Node B] ---------> [DB]
      \    user(1001- 2000)
       \
        \
         ---> ...
```
